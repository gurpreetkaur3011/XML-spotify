<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify</title>
    <style>
        /* Add your styles here */
        body {
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .main {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .card {
            width: 300px;
            margin: 10px;
            text-align: center;
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 8px;
        }

        .card img {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        #userInfo {
            text-align: center;
            display: none;
            margin-top: 20px;
        }

        #albums-container {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>

    <div class="main">
        <button id="loginBtn">Login with Spotify</button>
        <button id="getProfileBtn">Get Profile</button>
        
        <div id="userInfo" class="card">
            <h2>User Profile</h2>
            <p><strong>Display Name:</strong> <span id="displayName"></span></p>
            <p><strong>Email:</strong> <span id="email"></span></p>
            <p><strong>Country:</strong> <span id="country"></span></p>
            <p><strong>Followers:</strong> <span id="followers"></span></p>
            <p><strong>Spotify URI:</strong> <span id="spotifyUri"></span></p>
        </div>
        
        <h2 style="color: black;">New Releases</h2>
        <div id="albums-container"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const loginBtn = document.getElementById('loginBtn');
            const getProfileBtn = document.getElementById('getProfileBtn');
            const userInfo = document.getElementById('userInfo');
            const displayNameElement = document.getElementById('displayName');
            const emailElement = document.getElementById('email');
            const countryElement = document.getElementById('country');
            const followersElement = document.getElementById('followers');
            const spotifyUriElement = document.getElementById('spotifyUri');
            const albumsContainer = document.getElementById('albums-container');

            const clientId = 'da7a73500577472fa4ca42bed4cb1f3e';
            const redirectUri = 'http://127.0.0.1:5500/playlist-test.html';
            const scopes = 'user-read-private user-read-email';

            const authorizeUrl = `https://accounts.spotify.com/authorize?client_id=${clientId}&response_type=token&redirect_uri=${redirectUri}&scope=${scopes}`;

            loginBtn.addEventListener('click', () => {
                window.location.href = authorizeUrl;
            });

            getProfileBtn.addEventListener('click', () => {
                // Clear the new releases section
                albumsContainer.innerHTML = '';

                // Fetch user details using the access token
                const urlParams = new URLSearchParams(window.location.hash.substr(1));
                const accessToken = urlParams.get('access_token');

                if (accessToken) {
                    fetch('https://api.spotify.com/v1/me', {
                        headers: {
                            'Authorization': 'Bearer ' + accessToken,
                        },
                    })
                    .then(response => response.json())
                    .then(data => {
                        // Display user details
                        displayNameElement.innerText = data.display_name;
                        emailElement.innerText = data.email;
                        countryElement.innerText = data.country;
                        followersElement.innerText = data.followers.total;
                        spotifyUriElement.innerText = data.uri;

                        // Show the user info section
                        userInfo.style.display = 'block';

                        // Create card for user profile
                        const card = createCard(data);
                        albumsContainer.appendChild(card);
                    })
                    .catch(error => console.error('Error fetching user details:', error));
                }
            });

            function createCard(profile) {
                const card = document.createElement('div');
                card.className = 'card';

                const image = document.createElement('img');
                image.src = 'https://via.placeholder.com/150'; // You can replace this with the user's profile image URL
                image.alt = profile.display_name;

                const title = document.createElement('h4');
                title.textContent = profile.display_name;

                const email = document.createElement('p');
                email.textContent = profile.email;

                const country = document.createElement('p');
                country.textContent = profile.country;

                const followers = document.createElement('p');
                followers.textContent = `Followers: ${profile.followers.total}`;

                const spotifyUri = document.createElement('p');
                spotifyUri.textContent = `Spotify URI: ${profile.uri}`;

                card.appendChild(image);
                card.appendChild(title);
                card.appendChild(email);
                card.appendChild(country);
                card.appendChild(followers);
                card.appendChild(spotifyUri);

                return card;
            }
        });
    </script>
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify Search</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Spotify Search</h1>
        <input type="text" id="searchInput" placeholder="Search for an artist, album, or track">
        <button id="searchBtn">Search</button>
        <div id="results"></div>
    </div>
    <script>
     document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.getElementById('searchInput');
    const searchBtn = document.getElementById('searchBtn');
    const resultsContainer = document.getElementById('results');

    searchBtn.addEventListener('click', function () {
        const searchTerm = searchInput.value.trim();
        if (searchTerm !== '') {
            searchSpotify(searchTerm);
        }
    });

    function searchSpotify(query) {
        getToken().then(token => {
            const clientId = 'da7a73500577472fa4ca42bed4cb1f3e';
            const apiUrl = `https://api.spotify.com/v1/search?q=${encodeURIComponent(query)}&type=album,artist,track`;

            fetch(apiUrl, {
                headers: {
                    'Authorization': 'Bearer ' + token,
                },
            })
            .then(response => response.json())
            .then(data => {
                displayResults(data);
            })
            .catch(error => console.error('Error searching Spotify:', error));
        });
    }

    const clientId = 'da7a73500577472fa4ca42bed4cb1f3e';
    const clientSecret = 'dd71958f547f492fb6db0e57596ecc9c';   


    const getToken = async () => {
        const result = await fetch("https://accounts.spotify.com/api/token", {
            method: "POST",
            headers: {
                "Content-Type": "application/x-www-form-urlencoded",
                "Authorization": "Basic " + btoa(clientId + ":" + clientSecret),
            },
            body: "grant_type=client_credentials",
        });

        const data = await result.json();
        return data.access_token;
    };

    function displayResults(response) {
        // Log the entire response to see its structure
        console.log(response);

        if (!response || !response.albums || !response.albums.items) {
            console.error('Invalid response structure. Unable to display results.');
            return;
        }

        resultsContainer.innerHTML = '';

        const albums = response.albums.items;
        albums.forEach(album => {
            const albumCard = createAlbumCard(album);
            resultsContainer.appendChild(albumCard);
        });
    }

    function createAlbumCard(album) {
        const albumCard = document.createElement('div');
        albumCard.className = 'album-card';

        const albumImage = document.createElement('img');
        albumImage.src = album.images[0].url;
        albumImage.alt = album.name;

        const albumTitle = document.createElement('h4');
        albumTitle.textContent = `Album Name: ${album.name}`;

        const artistName = document.createElement('p');
        artistName.textContent = `Artist: ${album.artists[0].name}`;

        const releaseDate = document.createElement('p');
        releaseDate.textContent = `Release Date: ${album.release_date}`;

        const totalTracks = document.createElement('p');
        totalTracks.textContent = `Total Tracks: ${album.total_tracks}`;

        albumCard.appendChild(albumImage);
        albumCard.appendChild(albumTitle);
        albumCard.appendChild(artistName);
        albumCard.appendChild(releaseDate);
        albumCard.appendChild(totalTracks);

        return albumCard;
    }
});


    </script>
</body>
</html>
